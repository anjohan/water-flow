log ${OUTDIR}/log.flow
read_restart ${OUTDIR}/restart.water

units metal
boundary p p p
atom_style atomic

pair_style  usc
pair_coeff  * * ${INDIR}/SiO2H2O.vashishta Si O H
pair_modify coord 2 1 2.0 0.3
pair_modify coord 2 3 1.4 0.3
# pair_style vashishta
# pair_coeff	* * SiO2.vashishta Si O
mass            1 28.08
mass            2 15.9994
mass            3 1.00794

variable vx_water equal vcm(water,x)
variable is_water atom gmask(water)

thermo 100
thermo_style custom step time temp press etotal v_vx_water spcpu cpuremain

variable equilibration_time equal 20
variable equilibration_steps equal ${equilibrium_time}/dt

dump equidump all custom 100 ${OUTDIR}/dump.equilibration.bin  id type x y z vx vy vz xu yu zu fx fy fz v_is_water

group movingSiO2 union movingslab cylinder

fix silicathermostat movingSiO2 nvt temp $T $T 1.0
fix waterintegrator water nve

run ${equilibration_steps}

undump equidump

dump flow all custom 100 ${OUTDIR}/dump.flow.bin  id type x y z vx vy vz xu yu zu fx fy fz v_is_water
dump waterflow all custom 100 ${OUTDIR}/dump.waterflow.bin  id type x y z vx vy vz xu yu zu fx fy fz

variable flow_time equal 500
variable flow_steps equal ${flow_time}/dt

fix externalforce water addforce 0.0001 0.0 0.0

run ${flow_steps}

print "yay!" file ${OUTDIR}/done
